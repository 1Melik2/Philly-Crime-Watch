<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<title>Philadelphia Crime Dashboard</title>

		<script src="{{ url_for('static', filename='js/vizwit-embed.js') }}"></script>
		<link rel="stylesheet" href="{{ url_for('static', filename='css/data_style.css') }}">

	</head>

	<body>
		<nav style="margin-bottom: 20px;">
			<a href="{{ url_for('index') }}">Home</a> |
			<a href="{{ url_for('crime_map') }}">Crime Map</a> |
			<a href="{{ url_for('data') }}">Statistics</a> |
			<a href="{{ url_for('about') }}">About Us</a>
		</nav>
		<h1>Philadelphia Crime Dashboard</h1>

		<div>
			<label for="timeRange"><strong>Show data from:</strong></label>
			<select id="timeRange">
				<option value="1">Past 1 Day</option>
				<option value="7">Past 7 Days</option>
				<option value="30">Past 30 Days</option>
			</select>
		</div>

		<canvas id="crimeChart" width="400" height="200"></canvas>

		<h3>Chart Overview</h3>
		<ul id="crime-list">
			<li>Loading data...</li>
		</ul>

		<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
		<script src="{{ url_for('static', filename='js/dashboard_script.js') }}"></script>


		<h2>Crime Incidents by Location Block</h2>

		<div style="min-height: 500px; max-height: 700px;">
			<h2>Crime Incidents by Location Block</h2>

		<script class="vizwit" type="application/json">
		{
		"title": "Location (block)",
		"description": "Location of incidents generalized by street block",
		"chartType": "bar",
		"provider": "carto",
		"domain": "phl.carto.com",
		"dataset": "incidents_part1_part2",
		"groupBy": "location_block",
		"triggerField": "location_block",
		"baseFilters": [],
		"filters": {},
		"aggregateFunction": "count"
		}
		</script>
		</div>

		

		



		<section class="card">
			<h2>Police District Map</h2>
			<div class="map-container">
				<div id="police-district-map" style="width: 100%; height: 600px; position: relative;">
					<script class="vizwit" type="application/json">
					{
					"title": "Police District",
					"provider": "carto",
					"domain": "phl.carto.com",
					"dataset": "incidents_part1_part2",
					"chartType": "choropleth",
					"groupBy": "dc_dist",
					"boundaries": "https://phl.carto.com/api/v2/sql?q=select+*,+LPAD(dist_num::text,2,'0')+as+dist_num_text+from+police_districts&format=geojson",
					"boundariesLabel": "dist_num",
					"boundariesId": "dist_num_text",
					"triggerField": "dc_dist",
					"baseFilters": [],
					"filters": {},
					"aggregateFunction": "count",
					"colorScheme": "YlOrRd",
					"strokeColor": "#ffffff",
					"strokeWidth": 2,
					"fillOpacity": 0.8
					}
					</script>
				</div>
			</div>
		</section>

		<section class="card">
			<h2>Recent Crime Table</h2>

			<div class="vizwit-container">
				<script class="vizwit" type="application/json">
				{
				"title": "Crime Incidents",
				"chartType": "table",
				"provider": "carto",
				"domain": "phl.carto.com",
				"dataset": "incidents_part1_part2",
				"order": "dispatch_date_time desc",
				"columnsToHide": [
					"cartodb_id",
					"objectid",
					"the_geom",
					"the_geom_webmercator"
				],
				"baseFilters": [
					{
					"field": "dispatch_date_time",
					"expression": {
						"type": "is not",
						"value": null
					}
					}
				],
				"filters": {},
				"limit": 100,
				"offset": 0
				}
				</script>
			</div>
		</section>

	
	</body>
</html>
